---
import { Image } from 'astro:assets';

interface Props {
	title: string;
	type: string;
	date: string;
	endDate?: string | null;
	time: string;
	location: string;
	address?: string | null;
	description: string;
	image: string;
	status: string;
	price: string;
	highlights: string[];
}

const { title, type, date, endDate, time, location, description, image, status, price, highlights } =
	Astro.props;

// Format dates
function formatDate(dateString: string, endDateString?: string | null) {
	const dateObj = new Date(dateString);
	const options: Intl.DateTimeFormatOptions = {
		year: 'numeric',
		month: 'long',
		day: 'numeric',
	};
	if (endDateString) {
		const endDateObj = new Date(endDateString);
		return `${dateObj.toLocaleDateString('en-US', options)} - ${endDateObj.toLocaleDateString('en-US', options)}`;
	}
	return dateObj.toLocaleDateString('en-US', options);
}
---

<article
	data-type={type}
	class="event-card bg-white rounded-2xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 border border-gray-200"
>
	<div class="relative h-48 overflow-hidden">
		<Image
			src={image}
			alt={title}
			class="w-full h-full object-cover"
			width={1200}
			height={800}
			loading="lazy"
		/>
		<div class="absolute top-4 left-4">
			<span class="px-3 py-1 bg-primary text-white text-xs font-semibold rounded-full">
				{type}
			</span>
		</div>
		<div class="absolute top-4 right-4">
			<span
				class={`px-3 py-1 text-white text-xs font-semibold rounded-full ${
					status === 'Registration Open' ? 'bg-green' : 'bg-orange'
				}`}
			>
				{status}
			</span>
		</div>
	</div>
	<div class="p-6">
		<h3 class="text-xl font-bold text-gray-900 mb-3">{title}</h3>
		<div class="space-y-2 mb-4">
			<div class="flex items-start gap-2 text-sm text-gray-600">
				<svg
					class="w-4 h-4 flex-shrink-0 mt-0.5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
					aria-hidden="true"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
					></path>
				</svg>
				<span>{formatDate(date, endDate)}</span>
			</div>
			<div class="flex items-start gap-2 text-sm text-gray-600">
				<svg
					class="w-4 h-4 flex-shrink-0 mt-0.5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
					aria-hidden="true"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
				</svg>
				<span>{time}</span>
			</div>
			<div class="flex items-start gap-2 text-sm text-gray-600">
				<svg
					class="w-4 h-4 flex-shrink-0 mt-0.5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
					aria-hidden="true"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
					></path>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
				</svg>
				<span>{location}</span>
			</div>
		</div>
		<p class="text-gray-600 text-sm mb-4 line-clamp-3">{description}</p>
		<div class="mb-4">
			<p class="text-sm font-semibold text-gray-900 mb-2">Highlights:</p>
			<ul class="space-y-1">
				{
					highlights.slice(0, 3).map((highlight) => (
						<li class="flex items-start gap-2 text-xs text-gray-600">
							<svg
								class="w-3 h-3 text-primary flex-shrink-0 mt-0.5"
								fill="currentColor"
								viewBox="0 0 20 20"
								aria-hidden="true"
							>
								<path
									fill-rule="evenodd"
									d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
									clip-rule="evenodd"
								/>
							</svg>
							<span>{highlight}</span>
						</li>
					))
				}
			</ul>
		</div>
		<div class="flex items-center justify-between pt-4 border-t border-gray-200">
			<div>
				<p class="text-sm text-gray-500">Price</p>
				<p class="text-lg font-bold text-primary">{price}</p>
			</div>
			<a
				href="/contact"
				class="px-4 py-2 bg-primary hover:bg-primary-dark text-white text-sm font-semibold rounded-lg transition-colors"
			>
				Register
			</a>
		</div>
	</div>
</article>
