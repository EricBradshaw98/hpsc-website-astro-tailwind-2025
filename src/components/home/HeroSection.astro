---
import { Image } from 'astro:assets';

export interface HeroImage {
	src: string;
	alt: string;
}

export interface HeroCTA {
	text: string;
	href: string;
	style: 'primary' | 'secondary';
}

export interface HeroSectionProps {
	title: string;
	description: string;
	images: HeroImage[];
	ctas: HeroCTA[];
}

interface Props extends HeroSectionProps {}

const { title, description, images, ctas } = Astro.props;
---

<section class="mb-16 md:mt-4 max-w-7xl mx-auto md:px-4" aria-label="Hero section">
	<div
		class="rounded-none md:rounded-2xl px-4 md:px-16 py-20 md:py-24 text-white relative overflow-hidden"
		role="region"
		aria-label="Hero banner with rotating images"
	>
		<!-- Background Images with Gradient Overlay -->
		<div class="absolute inset-0 z-0" role="img" aria-label="Background carousel">
			{
				images.map((image, index) => (
					<Image
						id={`hero-img-${index + 1}`}
						src={image.src}
						alt={image.alt}
						class={`hero-image w-full h-full object-cover absolute inset-0 transition-opacity duration-1000 ${index === 0 ? 'opacity-100' : 'opacity-0'}`}
						width={1920}
						height={800}
						loading={index === 0 ? 'eager' : 'lazy'}
						role="presentation"
						aria-hidden={index !== 0 ? 'true' : 'false'}
					/>
				))
			}
			<div
				class="absolute inset-0 z-10 bg-gradient-to-r from-black/80 via-primary-900/85 to-primary-700/70"
			>
			</div>
		</div>
		<div class="w-full relative z-10 bg-black/60 p-6 md:p-8 rounded-lg">
			<h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6">
				{title}
			</h1>
			<p class="text-xl md:text-2xl mb-8">
				{description}
			</p>
			<nav aria-label="Hero call-to-action">
				<ul class="flex flex-wrap gap-4 list-none">
					{
						ctas.map((cta) => (
							<li>
								<a
									href={cta.href}
									class={
										cta.style === 'primary'
											? 'inline-block px-8 py-3 rounded-lg font-semibold transition-colors bg-white text-primary-900 hover:bg-primary-50 shadow-lg'
											: 'inline-block px-8 py-3 rounded-lg font-semibold bg-black/40 text-white border-2 border-white/80 hover:bg-white hover:text-primary-900 transition-colors shadow-md'
									}
									aria-label={cta.text}
								>
									{cta.text}
								</a>
							</li>
						))
					}
				</ul>
			</nav>
		</div>
	</div>
</section>

<script>
	// Hero image carousel with accessibility
	const heroImages = document.querySelectorAll('.hero-image');
	let currentHeroIndex = 0;
	const totalHeroImages = heroImages.length;

	function cycleHeroImages() {
		// Hide current image
		heroImages[currentHeroIndex].style.opacity = '0';
		heroImages[currentHeroIndex].setAttribute('aria-hidden', 'true');

		// Show next image
		currentHeroIndex = (currentHeroIndex + 1) % totalHeroImages;
		heroImages[currentHeroIndex].style.opacity = '1';
		heroImages[currentHeroIndex].setAttribute('aria-hidden', 'false');
	}

	// Respect user's motion preference
	const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

	if (totalHeroImages > 1 && !prefersReducedMotion) {
		setInterval(cycleHeroImages, 5000);
	}
</script>
